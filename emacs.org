#+TITLE: Emacs Configuration
#+AUTHOR: Giuseppe
#+PROPERTY: header-args :tangle (eval (expand-file-name "init.el" user-emacs-directory))
#+STARTUP: overview

For apply changes to the real configuration (init.el) run `org-babel-tangle`.

* Eglot
#+begin_src emacs-lisp
  (with-eval-after-load 'eglot
    (add-to-list 'eglot-server-programs '((simpc-mode) "clangd")))
  (add-hook 'eglot-managed-mode-hook #'company-mode)
#+end_src
* Multiple cursors
#+begin_src emacs-lisp
  (global-set-key (kbd "C-S-c C-S-c") 'mc/edit-beginnings-of-lines)
  (global-set-key (kbd "C->") 'mc/mark-next-like-this-word)
  (global-set-key (kbd "C-<") 'mc/mark-previous-like-this-word)
#+end_src
* Style
#+begin_src emacs-lisp
  ;; Generate early-init.el for faster startup
  (let ((early-init-file (expand-file-name "early-init.el" user-emacs-directory)))
    (unless (file-exists-p early-init-file)
      (with-temp-file early-init-file
        (let ((iosevka-font (if (member "IosevkaTerm Nerd Font Mono" (font-family-list))
                                "(font . \"IosevkaTerm NFM-12\")" "")))
          (insert (format ";;; early-init.el --- Generated by init.el

  (setq gc-cons-threshold most-positive-fixnum)
  (setq inhibit-startup-screen t)

  (setq default-frame-alist
    '((menu-bar-lines . 0)
      (tool-bar-lines . 0)
      (vertical-scroll-bars . nil)
      (tooltip . nil)
      (width  . 95)
      (height . 32)
      %s
      (background-color . \"#181818\")))

  (setq menu-bar-mode nil)
  (setq tool-bar-mode nil)
  (setq tooltip-mode nil)" iosevka-font))))))

  (setq-default indent-tabs-mode nil)
  (setq whitespace-style '(face tabs spaces trailing space-before-tab space-after-tab space-mark tab-mark))
  (setq indent-line-function 'insert-tab)
  (column-number-mode 1)
#+end_src
* Languages
** C
#+begin_src emacs-lisp
  (setq c-basic-offset 4)
  (add-to-list 'auto-mode-alist '("\\.[hc]\\(pp\\)?\\'" . simpc-mode))
#+end_src
*** Simpc-mode
References: https://github.com/rexim/simpc-mode
#+begin_src emacs-lisp
  ;; Commit 958aeb9
  (require 'subr-x)

  (defvar simpc-mode-syntax-table
    (let ((table (make-syntax-table)))
      ;; C/C++ style comments
      (modify-syntax-entry ?/ ". 124b" table)
      (modify-syntax-entry ?* ". 23" table)
      (modify-syntax-entry ?\n "> b" table)
      ;; Preprocessor stuff?
      (modify-syntax-entry ?# "." table)
      ;; Chars are the same as strings
      (modify-syntax-entry ?' "\"" table)
      ;; Treat <> as punctuation (needed to highlight C++ keywords
      ;; properly in template syntax)
      (modify-syntax-entry ?< "." table)
      (modify-syntax-entry ?> "." table)

      (modify-syntax-entry ?& "." table)
      (modify-syntax-entry ?% "." table)
      table))

  (defun simpc-types ()
    '("char" "int" "long" "short" "void" "bool" "float" "double" "signed" "unsigned"
      "char16_t" "char32_t" "char8_t"
      "int8_t" "uint8_t" "int16_t" "uint16_t" "int32_t" "uint32_t" "int64_t" "uint64_t"
      "uintptr_t"
      "size_t"
      "va_list"))

  (defun simpc-keywords ()
    '("auto" "break" "case" "const" "continue" "default" "do"
      "else" "enum" "extern" "for" "goto" "if" "register"
      "return"  "sizeof" "static" "struct" "switch" "typedef"
      "union"  "volatile" "while" "alignas" "alignof" "and"
      "and_eq" "asm" "atomic_cancel" "atomic_commit" "atomic_noexcept" "bitand"
      "bitor" "catch"  "class" "co_await"
      "co_return" "co_yield" "compl" "concept" "const_cast" "consteval" "constexpr"
      "constinit" "decltype" "delete" "dynamic_cast" "explicit" "export" "false"
      "friend" "inline" "mutable" "namespace" "new" "noexcept" "not" "not_eq"
      "nullptr" "operator" "or" "or_eq" "private" "protected" "public" "reflexpr"
      "reinterpret_cast" "requires" "static_assert" "static_cast" "synchronized"
      "template" "this" "thread_local" "throw" "true" "try" "typeid" "typename"
      "using" "virtual" "wchar_t" "xor" "xor_eq"))

  (defun simpc-font-lock-keywords ()
    (list
     `("# *\\(warn\\|error\\)" . font-lock-warning-face)
     `("# *[#a-zA-Z0-9_]+" . font-lock-preprocessor-face)
     `("# *include\\(?:_next\\)?\\s-+\\(\\(<\\|\"\\).*\\(>\\|\"\\)\\)" . (1 font-lock-string-face))
     `("\\(?:enum\\|struct\\)\\s-+\\([a-zA-Z0-9_]+\\)" . (1 font-lock-type-face))
     `(,(regexp-opt (simpc-keywords) 'symbols) . font-lock-keyword-face)
     `(,(regexp-opt (simpc-types) 'symbols) . font-lock-type-face)))

  (defun simpc--previous-non-empty-line ()
    "Returns either NIL when there is no such line or a pair (line . indentation)"
    (save-excursion
      ;; If you are on the first line, but not at the beginning of buffer (BOB) the `(bobp)`
      ;; function does not return `t`. So we have to move to the beginning of the line first.
      ;; TODO: feel free to suggest a better approach for checking BOB here.
      (move-beginning-of-line nil)
      (if (bobp)
          ;; If you are standing at the BOB, you by definition don't have a previous non-empty line.
          nil
        ;; Moving one line backwards because the current line is by definition is not
        ;; the previous non-empty line.
        (forward-line -1)
        ;; Keep moving backwards until we hit BOB or a non-empty line.
        (while (and (not (bobp))
                    (string-empty-p
                     (string-trim-right
                      (thing-at-point 'line t))))
          (forward-line -1))

        (if (string-empty-p
             (string-trim-right
              (thing-at-point 'line t)))
            ;; If after moving backwards for this long we still look at an empty
            ;; line we by definition didn't find the previous non-empty line.
            nil
          ;; We found the previous non-empty line!
          (cons (thing-at-point 'line t)
                (current-indentation))))))

  (defun simpc--desired-indentation ()
    (let ((prev (simpc--previous-non-empty-line)))
      (if (not prev)
          (current-indentation)
        (let ((indent-len 4)
              (cur-line (string-trim-right (thing-at-point 'line t)))
              (prev-line (string-trim-right (car prev)))
              (prev-indent (cdr prev)))
          (cond
           ((string-match-p "^\\s-*switch\\s-*(.+)" prev-line)
            prev-indent)
           ((and (string-suffix-p "{" prev-line)
                 (string-prefix-p "}" (string-trim-left cur-line)))
            prev-indent)
           ((string-suffix-p "{" prev-line)
            (+ prev-indent indent-len))
           ((string-prefix-p "}" (string-trim-left cur-line))
            (max (- prev-indent indent-len) 0))
           ((string-suffix-p ":" prev-line)
            (if (string-suffix-p ":" cur-line)
                prev-indent
              (+ prev-indent indent-len)))
           ((string-suffix-p ":" cur-line)
            (max (- prev-indent indent-len) 0))
           (t prev-indent))))))

  ;;; TODO: customizable indentation (amount of spaces, tabs, etc)
  (defun simpc-indent-line ()
    (interactive)
    (when (not (bobp))
      (let* ((desired-indentation
              (simpc--desired-indentation))
             (n (max (- (current-column) (current-indentation)) 0)))
        (indent-line-to desired-indentation)
        (forward-char n))))

  (define-derived-mode simpc-mode prog-mode "Simple C"
    "Simple major mode for editing C files."
    :syntax-table simpc-mode-syntax-table
    (setq-local font-lock-defaults '(simpc-font-lock-keywords))
    (setq-local indent-line-function 'simpc-indent-line)
    (setq-local comment-start "// "))

  (provide 'simpc-mode)
#+end_src
** Typst
#+begin_src emacs-lisp
  ;; https://github.com/Ziqi-Yang/typst-mode.el
  ;; (add-to-list 'auto-mode-alist '("\\.typ\\'" . typst-mode))
#+end_src
* IDO vertical
#+begin_src emacs-lisp
  (ido-mode t)
  (ido-everywhere t)
  (setq ido-enable-flex-matching t)
  (setq ido-decorations
        '("\n-> " "" "\n   " "\n   ..." " [" "]" " [No match]" " [Matched]" " [Not readable]" " [Too big]" " [Confirm]"))

  (define-key ido-common-completion-map (kbd "C-n") 'ido-next-match)
  (define-key ido-common-completion-map (kbd "C-p") 'ido-prev-match)
#+end_src
* Org mode
#+begin_src emacs-lisp
  (setq org-startup-folded t)
  (setq org-hide-emphasis-markers t)

  (custom-set-faces
   '(org-document-title ((t (:foreground "yellow" :bold t :height 1.4))))
   '(org-document-info ((t (:foreground "yellow" :height 1.3))))
   '(org-level-1 ((t (:foreground "dark orange" :inherit outline-1 :height 1.2))))
   '(org-level-2 ((t (:foreground "gold" :inherit outline-2 :height 1.1))))
   '(org-level-3 ((t (:foreground "lawn green" :inherit outline-3))))
   '(org-todo ((t (:foreground "red" :bold t :height 0.9))))
   '(org-done ((t (:foreground "PaleGreen" :height 0.9))))
   '(org-document-info-keyword ((t (:foreground "gray" :height 0.9))))
   '(org-meta-line ((t (:foreground "gray" :height 0.9))))
   '(org-block ((t (:background "#181818" :foreground "gray")))))
#+end_src
* Dired
#+begin_src emacs-lisp
  (if (eq system-type 'gnu/linux)
      (setq dired-listing-switches "-lhAX --group-directories-first")
    (setq dired-listing-switches "-lhAX"))
  (setq dired-dwim-target t)
#+end_src
* Eshell
#+begin_src emacs-lisp
  (defun custom/eshell-split-vertical ()
    (interactive)
    (split-window-vertically)
    (other-window 1)
    (eshell 'N))

  (defun custom/eshell-split-horizontal ()
    (interactive)
    (split-window-horizontally)
    (other-window 1)
    (eshell 'N))

  (global-set-key (kbd "C-x C-<return> 3") 'custom/eshell-split-horizontal)
  (global-set-key (kbd "C-x C-<return> 2") 'custom/eshell-split-vertical)
  (global-set-key (kbd "C-x C-<return> C-<return>") (lambda () (interactive) (eshell 'N)))
#+end_src
* Garbage collector
References: https://jackjamison.xyz/blog/emacs-garbage-collection/
#+begin_src emacs-lisp
  (defun my-minibuffer-exit-hook ()
    (setq gc-cons-threshold 800000000))

  (add-hook 'minibuffer-exit-hook #'my-minibuffer-exit-hook)

  (defun gc-idle-timer ()
    "Trigger garbage collection when Emacs is idle for 0.5 seconds."
    (run-with-idle-timer 1.2 t 'garbage-collect))

  (gc-idle-timer)
#+end_src
* Custom functions
#+begin_src emacs-lisp
  (defun custom/install-pkgs ()
    "Install some useful packages."
    (interactive)
    (require 'package)
    (setq native-comp-async-report-warnings-errors nil)
    (package-initialize)

    (unless package-archive-contents
      (package-refresh-contents))

    (let ((pkgs '(magit eglot company multiple-cursors)))
      (dolist (pkg pkgs)
        (unless (package-installed-p pkg)
          (package-install pkg)))))

  (defun custom/install-iosevka-font ()
    "Install Iosevka Fonts if it doesn't exist (works only on linux)."
    (interactive)
    (let ((font (expand-file-name "~/.local/share/fonts/IosevkaTermNerdFont-Regular.ttf"))
          (font-dir (expand-file-name "~/.local/share/fonts"))
          (tarball (expand-file-name "IosevkaTerm.tar.xz" temporary-file-directory))
          (url "https://github.com/ryanoasis/nerd-fonts/releases/download/v3.4.0/IosevkaTerm.tar.xz"))

      (unless (file-exists-p font)
        (make-directory font-dir t)
        (url-copy-file url tarball t)
        (call-process "tar" nil nil nil "-xf" tarball "-C" font-dir)
        (call-process "fc-cache" nil nil nil "-f")
        (delete-file tarball)
        (message "Iosevka Fonts installed."))))

  (defun custom/fix-accent ()
    (interactive)
    (beginning-of-buffer)
    (query-replace "a'" "à")
    (beginning-of-buffer)
    (query-replace "e'" "è")
    (beginning-of-buffer)
    (query-replace "i'" "ì")
    (beginning-of-buffer)
    (query-replace "o'" "ò")
    (beginning-of-buffer)
    (query-replace "u'" "ù"))

  (defun custom/expand-region (&optional arg)
    (interactive "p")
    (backward-up-list arg (point) (point))
    (mark-sexp))
#+end_src
* Custom keybinds
#+begin_src emacs-lisp
  (global-set-key (kbd "M-!") 'compile)
  (global-set-key (kbd "C-v") (lambda () (interactive) (scroll-up (/ (window-body-height) 2))))
  (global-set-key (kbd "M-v") (lambda () (interactive) (scroll-down (/ (window-body-height) 2))))
  (global-set-key (kbd "M-n") 'dabbrev-expand)
  (global-set-key (kbd "C-x C-o") 'other-window)
  (global-set-key (kbd "C-@") 'custom/expand-region)
  (with-eval-after-load 'dired
    (define-key dired-mode-map [mouse-2] #'dired-mouse-find-file))
#+end_src
* Hooks
#+begin_src emacs-lisp
  (add-hook 'prog-mode-hook #'electric-pair-mode)
  (add-hook 'dired-mode-hook #'auto-revert-mode)
  (add-hook 'org-mode-hook #'org-indent-mode)
#+end_src
* TTY
#+begin_src emacs-lisp
  (unless (display-graphic-p)
    (global-set-key (kbd "C-x RET 3") 'custom/eshell-split-horizontal)
    (global-set-key (kbd "C-x RET 2") 'custom/eshell-split-vertical)
    (global-set-key (kbd "C-x RET RET") (lambda () (interactive) (eshell 'N)))
    (global-set-key (kbd "C-@") 'set-mark-command)
    (remove-hook 'org-mode-hook #'org-indent-mode)
    (unless (string-match-p "N/A" (battery))
      (display-battery-mode)))
#+end_src
* Theme
#+begin_src emacs-lisp
  ;; gruber-darker-theme.el --- Gruber Darker color theme for Emacs 24.
  ;; Version: 0.7

  (deftheme gruber-darker
    "Gruber Darker color theme for Emacs 24")

  ;; Please, install rainbow-mode.
  ;; Colors with +x are lighter. Colors with -x are darker.
  (let ((gruber-darker-fg        "#e4e4ef")
        (gruber-darker-fg+1      "#f4f4ff")
        (gruber-darker-fg+2      "#f5f5f5")
        (gruber-darker-white     "#ffffff")
        (gruber-darker-black     "#000000")
        (gruber-darker-bg-1      "#101010")
        (gruber-darker-bg        "#181818")
        (gruber-darker-bg+1      "#282828")
        (gruber-darker-bg+2      "#453d41")
        (gruber-darker-bg+3      "#484848")
        (gruber-darker-bg+4      "#52494e")
        (gruber-darker-red-1     "#c73c3f")
        (gruber-darker-red       "#f43841")
        (gruber-darker-red+1     "#ff4f58")
        (gruber-darker-green     "#73c936")
        (gruber-darker-yellow    "#ffdd33")
        (gruber-darker-brown     "#cc8c3c")
        (gruber-darker-quartz    "#95a99f")
        (gruber-darker-niagara-2 "#303540")
        (gruber-darker-niagara-1 "#565f73")
        (gruber-darker-niagara   "#96a6c8")
        (gruber-darker-wisteria  "#9e95c7")
        )
    (custom-theme-set-variables
     'gruber-darker
     '(frame-brackground-mode (quote dark)))

    (custom-theme-set-faces
     'gruber-darker

     ;; Basic Coloring (or Uncategorized)
     `(border ((t ,(list :background gruber-darker-bg-1
                         :foreground gruber-darker-bg+2))))
     `(cursor ((t (:background ,gruber-darker-yellow))))
     `(default ((t ,(list :foreground gruber-darker-fg
                          :background gruber-darker-bg))))
     `(fringe ((t ,(list :background 'unspecified
                         :foreground gruber-darker-bg+2))))
     `(vertical-border ((t ,(list :foreground gruber-darker-bg+2))))
     `(link ((t (:foreground ,gruber-darker-niagara :underline t))))
     `(link-visited ((t (:foreground ,gruber-darker-wisteria :underline t))))
     `(match ((t (:background ,gruber-darker-bg+4))))
     `(shadow ((t (:foreground ,gruber-darker-bg+4))))
     `(minibuffer-prompt ((t (:foreground ,gruber-darker-niagara))))
     `(region ((t (:background ,gruber-darker-bg+3 :foreground unspecified))))
     `(secondary-selection ((t ,(list :background gruber-darker-bg+3
                                      :foreground 'unspecified))))
     `(trailing-whitespace ((t ,(list :foreground gruber-darker-black
                                      :background gruber-darker-red))))
     `(tooltip ((t ,(list :background gruber-darker-bg+4
                          :foreground gruber-darker-white))))

     ;; Calendar
     `(holiday-face ((t (:foreground ,gruber-darker-red))))

     ;; Compilation
     `(compilation-info ((t ,(list :foreground gruber-darker-green
                                   :inherit 'unspecified))))
     `(compilation-warning ((t ,(list :foreground gruber-darker-brown
                                      :bold t
                                      :inherit 'unspecified))))
     `(compilation-error ((t (:foreground ,gruber-darker-red+1))))
     `(compilation-mode-line-fail ((t ,(list :foreground gruber-darker-red
                                             :weight 'bold
                                             :inherit 'unspecified))))
     `(compilation-mode-line-exit ((t ,(list :foreground gruber-darker-green
                                             :weight 'bold
                                             :inherit 'unspecified))))

     ;; Completion
     `(completions-annotations ((t (:inherit 'shadow))))

     ;; Custom
     `(custom-state ((t (:foreground ,gruber-darker-green))))

     ;; Diff
     `(diff-removed ((t ,(list :foreground gruber-darker-red+1
                               :background 'unspecified))))
     `(diff-added ((t ,(list :foreground gruber-darker-green
                             :background 'unspecified))))

     ;; Dired
     `(dired-directory ((t (:foreground ,gruber-darker-niagara :weight bold))))
     `(dired-ignored ((t ,(list :foreground gruber-darker-quartz
                                :inherit 'unspecified))))

     ;; EShell
     `(eshell-ls-backup ((t (:foreground ,gruber-darker-quartz))))
     `(eshell-ls-directory ((t (:foreground ,gruber-darker-niagara))))
     `(eshell-ls-executable ((t (:foreground ,gruber-darker-green))))
     `(eshell-ls-symlink ((t (:foreground ,gruber-darker-yellow))))

     ;; Font Lock
     `(font-lock-builtin-face ((t (:foreground ,gruber-darker-yellow))))
     `(font-lock-comment-face ((t (:foreground ,gruber-darker-brown))))
     `(font-lock-comment-delimiter-face ((t (:foreground ,gruber-darker-brown))))
     `(font-lock-constant-face ((t (:foreground ,gruber-darker-quartz))))
     `(font-lock-doc-face ((t (:foreground ,gruber-darker-green))))
     `(font-lock-doc-string-face ((t (:foreground ,gruber-darker-green))))
     `(font-lock-function-name-face ((t (:foreground ,gruber-darker-niagara))))
     `(font-lock-keyword-face ((t (:foreground ,gruber-darker-yellow :bold t))))
     `(font-lock-preprocessor-face ((t (:foreground ,gruber-darker-quartz))))
     `(font-lock-reference-face ((t (:foreground ,gruber-darker-quartz))))
     `(font-lock-string-face ((t (:foreground ,gruber-darker-green))))
     `(font-lock-type-face ((t (:foreground ,gruber-darker-quartz))))
     `(font-lock-variable-name-face ((t (:foreground ,gruber-darker-fg+1))))
     `(font-lock-warning-face ((t (:foreground ,gruber-darker-red))))

     ;; Flymake
     `(flymake-errline
       ((((supports :underline (:style wave)))
         (:underline (:style wave :color ,gruber-darker-red)
                     :foreground unspecified
                     :background unspecified
                     :inherit unspecified))
        (t (:foreground ,gruber-darker-red :weight bold :underline t))))
     `(flymake-warnline
       ((((supports :underline (:style wave)))
         (:underline (:style wave :color ,gruber-darker-yellow)
                     :foreground unspecified
                     :background unspecified
                     :inherit unspecified))
        (t (:forground ,gruber-darker-yellow :weight bold :underline t))))
     `(flymake-infoline
       ((((supports :underline (:style wave)))
         (:underline (:style wave :color ,gruber-darker-green)
                     :foreground unspecified
                     :background unspecified
                     :inherit unspecified))
        (t (:forground ,gruber-darker-green :weight bold :underline t))))

     ;; Flyspell
     `(flyspell-incorrect
       ((((supports :underline (:style wave)))
         (:underline (:style wave :color ,gruber-darker-red) :inherit unspecified))
        (t (:foreground ,gruber-darker-red :weight bold :underline t))))
     `(flyspell-duplicate
       ((((supports :underline (:style wave)))
         (:underline (:style wave :color ,gruber-darker-yellow) :inherit unspecified))
        (t (:foreground ,gruber-darker-yellow :weight bold :underline t))))

     ;; Ido
     `(ido-first-match ((t (:foreground ,gruber-darker-yellow :bold nil))))
     `(ido-only-match ((t (:foreground ,gruber-darker-brown :weight bold))))
     `(ido-subdir ((t (:foreground ,gruber-darker-niagara :weight bold))))

     ;; Info
     `(info-xref ((t (:foreground ,gruber-darker-niagara))))
     `(info-visited ((t (:foreground ,gruber-darker-wisteria))))

     ;; line numbers
     `(line-number ((t (:inherit default :foreground ,gruber-darker-bg+4))))
     `(line-number-current-line ((t (:inherit line-number :foreground ,gruber-darker-yellow))))

     ;; Magit
     `(magit-branch ((t (:foreground ,gruber-darker-niagara))))
     `(magit-diff-hunk-header ((t (:background ,gruber-darker-bg+2))))
     `(magit-diff-file-header ((t (:background ,gruber-darker-bg+4))))
     `(magit-log-sha1 ((t (:foreground ,gruber-darker-red+1))))
     `(magit-log-author ((t (:foreground ,gruber-darker-brown))))
     `(magit-log-head-label-remote ((t ,(list :foreground gruber-darker-green
                                              :background gruber-darker-bg+1))))
     `(magit-log-head-label-local ((t ,(list :foreground gruber-darker-niagara
                                             :background gruber-darker-bg+1))))
     `(magit-log-head-label-tags ((t ,(list :foreground gruber-darker-yellow
                                            :background gruber-darker-bg+1))))
     `(magit-log-head-label-head ((t ,(list :foreground gruber-darker-fg
                                            :background gruber-darker-bg+1))))
     `(magit-item-highlight ((t (:background ,gruber-darker-bg+1))))
     `(magit-tag ((t ,(list :foreground gruber-darker-yellow
                            :background gruber-darker-bg))))
     `(magit-blame-heading ((t ,(list :background gruber-darker-bg+1
                                      :foreground gruber-darker-fg))))

     ;; Message
     `(message-header-name ((t (:foreground ,gruber-darker-green))))

     ;; Mode Line
     `(mode-line ((t ,(list :background gruber-darker-bg+1
                            :foreground gruber-darker-white))))
     `(mode-line-buffer-id ((t ,(list :background gruber-darker-bg+1
                                      :foreground gruber-darker-white))))
     `(mode-line-inactive ((t ,(list :background gruber-darker-bg+1
                                     :foreground gruber-darker-quartz))))

     ;; Org Mode
     `(org-agenda-structure ((t (:foreground ,gruber-darker-niagara))))
     `(org-column ((t (:background ,gruber-darker-bg-1))))
     `(org-column-title ((t (:background ,gruber-darker-bg-1 :underline t :weight bold))))
     `(org-done ((t (:foreground ,gruber-darker-green))))
     `(org-todo ((t (:foreground ,gruber-darker-red-1))))
     `(org-upcoming-deadline ((t (:foreground ,gruber-darker-yellow))))

     ;; Search
     `(isearch ((t ,(list :foreground gruber-darker-black
                          :background gruber-darker-fg+2))))
     `(isearch-fail ((t ,(list :foreground gruber-darker-black
                               :background gruber-darker-red))))
     `(isearch-lazy-highlight-face ((t ,(list
                                         :foreground gruber-darker-fg+1
                                         :background gruber-darker-niagara-1))))

     ;; Sh
     `(sh-quoted-exec ((t (:foreground ,gruber-darker-red+1))))

     ;; Show Paren
     `(show-paren-match-face ((t (:background ,gruber-darker-bg+4))))
     `(show-paren-mismatch-face ((t (:background ,gruber-darker-red-1))))

     ;; Whitespace
     `(whitespace-space ((t ,(list :background gruber-darker-bg
                                   :foreground gruber-darker-bg+1))))
     `(whitespace-tab ((t ,(list :background gruber-darker-bg
                                 :foreground gruber-darker-bg+1))))
     `(whitespace-hspace ((t ,(list :background gruber-darker-bg
                                    :foreground gruber-darker-bg+2))))
     `(whitespace-line ((t ,(list :background gruber-darker-bg+2
                                  :foreground gruber-darker-red+1))))
     `(whitespace-newline ((t ,(list :background gruber-darker-bg
                                     :foreground gruber-darker-bg+2))))
     `(whitespace-trailing ((t ,(list :background gruber-darker-red
                                      :foreground gruber-darker-red))))
     `(whitespace-empty ((t ,(list :background gruber-darker-yellow
                                   :foreground gruber-darker-yellow))))
     `(whitespace-indentation ((t ,(list :background gruber-darker-yellow
                                         :foreground gruber-darker-red))))
     `(whitespace-space-after-tab ((t ,(list :background gruber-darker-yellow
                                             :foreground gruber-darker-yellow))))
     `(whitespace-space-before-tab ((t ,(list :background gruber-darker-brown
                                              :foreground gruber-darker-brown))))

     ;; vterm / ansi-term
     `(term-color-black ((t (:foreground ,gruber-darker-bg+3 :background ,gruber-darker-bg+4))))
     `(term-color-red ((t (:foreground ,gruber-darker-red-1 :background ,gruber-darker-red-1))))
     `(term-color-green ((t (:foreground ,gruber-darker-green :background ,gruber-darker-green))))
     `(term-color-blue ((t (:foreground ,gruber-darker-niagara :background ,gruber-darker-niagara))))
     `(term-color-yellow ((t (:foreground ,gruber-darker-yellow :background ,gruber-darker-yellow))))
     `(term-color-magenta ((t (:foreground ,gruber-darker-wisteria :background ,gruber-darker-wisteria))))
     `(term-color-cyan ((t (:foreground ,gruber-darker-quartz :background ,gruber-darker-quartz))))
     `(term-color-white ((t (:foreground ,gruber-darker-fg :background ,gruber-darker-white))))

     ;; company-mode
     `(company-tooltip ((t (:foreground ,gruber-darker-fg :background ,gruber-darker-bg+1))))
     `(company-tooltip-annotation ((t (:foreground ,gruber-darker-brown :background ,gruber-darker-bg+1))))
     `(company-tooltip-annotation-selection ((t (:foreground ,gruber-darker-brown :background ,gruber-darker-bg-1))))
     `(company-tooltip-selection ((t (:foreground ,gruber-darker-fg :background ,gruber-darker-bg-1))))
     `(company-tooltip-mouse ((t (:background ,gruber-darker-bg-1))))
     `(company-tooltip-common ((t (:foreground ,gruber-darker-green))))
     `(company-tooltip-common-selection ((t (:foreground ,gruber-darker-green))))
     `(company-scrollbar-fg ((t (:background ,gruber-darker-bg-1))))
     `(company-scrollbar-bg ((t (:background ,gruber-darker-bg+2))))
     `(company-preview ((t (:background ,gruber-darker-green))))
     `(company-preview-common ((t (:foreground ,gruber-darker-green :background ,gruber-darker-bg-1))))
     ))

  (enable-theme 'gruber-darker)
#+end_src
* Misc
#+begin_src emacs-lisp
  (setq auto-save-default nil)
  (setq use-short-answers 1)
  (setq compile-command "")
  (setq calendar-week-start-day 1)
  (setq vc-follow-symlinks t)
  (setq use-dialog-box nil)
  (setq make-backup-files nil)
  (setq gamegrid-glyph-height-mm 10.0) ;; Tetris size fix
#+end_src
